<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1>Hoi Client</h1>
    <h2><a href="https://login.microsoftonline.com/030b09d5-7f0f-40b0-8c01-03ac319b2d71/oauth2/v2.0/authorize?
                        client_id=15c193fe-d2ee-4ec5-96a0-e788ed2fee41
                        &response_type=token
                        &redirect_uri=https://localhost:7019/index.html
                        &scope=api://f0c5f3ae-582c-4cfb-956c-ffb826836af4/Access
                        &response_mode=fragment
                        &state=12345
                        &nonce=678910">Login</a></h2>

    <h1 id="txt"></h1>
    <script>
        let arr = window.location.hash.substring(1).split("&");
            console.log(window.location.hash.substring(1));
            let token = arr[0].split("=")[1];
            console.log(token);
            
            async function Call()
            {
                try
                {
                let resp =  await fetch("https://localhost:7209/weatherforecast", {
                    headers:{
                        "Authorization": "Bearer " + token
                        }
                    })
                    let js = await resp.text();
                    document.querySelector("#txt").textContent = js;
                }
                catch(error)
                {
                    document.querySelector("#txt").textContent = error;
                }
            }
            
            Call();
            
    </script>
</body>
</html>